// Experience Data
const experienceData = {
    en: [
        {
            title: "Sr. Data Scientist",
            company: "Cadena Platforms LLC",
            date: "Jun 2024 - Present",
            location: "Remote",
            description: [
                "Development of dashboards for various company projects",
                "Vulnerability assessment in LLM models",
                "Evaluation of conversations using AI to determine user intentions"
            ]
        },
        {
            title: "Machine Learning Scientist II",
            company: "Flipp",
            date: "Apr 2022 - May 2024",
            location: "Remote",
            description: [
                "Participation in creating User Value models",
                "Training new team members",
                "Exploration of techniques to personalize content for users",
                "Exploration of reinforcement learning techniques for user segmentation"
            ]
        },
        {
            title: "Sr. Data Scientist",
            company: "BeBopBee",
            date: "Jun 2021 - Apr 2022",
            location: "Remote",
            description: [
                "Automation of ELT processes using Matillion",
                "Data collection from different APIs",
                "Development of dashboards for decision-making using Data Studio and Amplitude",
                "Use of AWS Lambda functions to collect data from different sources",
                "Development of complex database queries to ensure data consistency",
                "Exploration of new technologies (Meltano, Airflow, Superset)"
            ]
        },
        {
            title: "Sr. Data Scientist",
            company: "Gram Games",
            date: "Aug 2020 - May 2021",
            location: "London, England",
            description: [
                "Analysis of hypothesis tests for product decision-making",
                "Data analysis to find possible causes of game issues",
                "Use of statistical techniques to find anomalies in data",
                "Creation of an anomaly detection system",
                "Automation and improvement of reports"
            ]
        },
        {
            title: "Lead Data Scientist",
            company: "JamCity",
            date: "Nov 2018 - Apr 2020",
            location: "BogotÃ¡, Colombia",
            description: [
                "Training new team members",
                "Adaptation of an MMR system for a 1v1 player vs player game",
                "Development of database queries for report automation",
                "Development of systems for S2S data communication and transfer",
                "Leadership of a data science team located in BogotÃ¡ and Buenos Aires",
                "Optimization of query execution time",
                "Creation of an alert system for specific game metrics"
            ]
        },
        {
            title: "Lead Data Scientist",
            company: "JamCity",
            date: "Sep 2017 - Nov 2018",
            location: "Buenos Aires, Argentina",
            description: [
                "Implementation of parametric and non-parametric user value models at user level",
                "Improvement of user churn detection models",
                "Development of an R package for internal company use",
                "Evaluation of new technologies for model training",
                "Development of Deep Learning models for image classification",
                "Development of models to generate better user experience for players"
            ]
        },
        {
            title: "Data Scientist",
            company: "Agnostic IT",
            date: "Dec 2016 - Sep 2017",
            location: "Buenos Aires, Argentina",
            description: [
                "Modeling of a Machine Learning system for user churn detection in an insurance company",
                "Statistical and Machine Learning consulting"
            ]
        },
        {
            title: "Data Scientist",
            company: "JamCity",
            date: "Aug 2015 - Dec 2016",
            location: "Buenos Aires, Argentina",
            description: [
                "Modeling of Machine Learning algorithms for user churn and user value",
                "Improvement of calculation to estimate user skill based on difficulty of levels played"
            ]
        }
    ],
    es: [
        {
            title: "Sr. Data Scientist",
            company: "Cadena Platforms LLC",
            date: "Jun 2024 - Actualmente",
            location: "Remoto",
            description: [
                "ElaboraciÃ³n de Dashboards para diferentes proyectos de la empresa",
                "EvaluaciÃ³n de vulnerabilidades en modelos LLM",
                "EvaluaciÃ³n de conversaciones usando AI para determinar intenciones de usuarios"
            ]
        },
        {
            title: "Machine Learning Scientist II",
            company: "Flipp",
            date: "Abr 2022 - Mayo 2024",
            location: "Remoto",
            description: [
                "ParticipaciÃ³n en la creaciÃ³n de modelos de Valor de Usuario",
                "Entrenamiento de nuevos miembros del equipo",
                "ExploraciÃ³n de tÃ©cnicas para personalizar contenido para los usuarios",
                "ExploraciÃ³n de tÃ©cnicas de aprendizaje por refuerzo para segmentaciÃ³n de usuarios"
            ]
        },
        {
            title: "Sr. Data Scientist",
            company: "BeBopBee",
            date: "Jun 2021 - Abr 2022",
            location: "Remoto",
            description: [
                "AutomatizaciÃ³n de procesos para ELT usando Matillion",
                "RecolecciÃ³n de datos de diferentes API",
                "ElaboraciÃ³n de Dashboards para toma de decisiones usando Data Studio y Amplitude",
                "Uso de funciones de AWS Lambda para recolectar datos de diferentes fuentes",
                "ElaboraciÃ³n de consultas complejas a bases de datos para asegurar la consistencia de los datos",
                "ExploraciÃ³n de nuevas tecnologÃ­as (Meltano, Airflow, Superset)"
            ]
        },
        {
            title: "Sr. Data Scientist",
            company: "Gram Games",
            date: "Ago 2020 - Mayo 2021",
            location: "Londres, Inglaterra",
            description: [
                "AnÃ¡lisis de pruebas de hipÃ³tesis para toma de decisiones de producto",
                "AnÃ¡lisis de datos para encontrar posibles causas a problemas de los juegos",
                "Uso de tÃ©cnicas estadÃ­sticas para encontrar anomalÃ­as en los datos",
                "CreaciÃ³n de un sistema de detecciÃ³n de anomalÃ­as",
                "AutomatizaciÃ³n y mejora de reportes"
            ]
        },
        {
            title: "Lead Data Scientist",
            company: "JamCity",
            date: "Nov 2018 - Abr 2020",
            location: "BogotÃ¡, Colombia",
            description: [
                "Entrenamiento de nuevos miembros del equipo",
                "AdaptaciÃ³n de un sistema de MMR para un juego jugador contra jugador 1v1",
                "ElaboraciÃ³n de consultas a la base de datos para automatizaciÃ³n de reportes",
                "ElaboraciÃ³n de sistemas para la comunicaciÃ³n y transferencia de datos S2S",
                "Liderazgo de un equipo de cientÃ­ficos de datos ubicados en BogotÃ¡ y Buenos Aires",
                "OptimizaciÃ³n de tiempo de ejecuciÃ³n de consultas",
                "CreaciÃ³n de un sistema de alertas para mÃ©tricas especÃ­ficas de los juegos"
            ]
        },
        {
            title: "Lead Data Scientist",
            company: "JamCity",
            date: "Sept 2017 - Nov 2018",
            location: "Buenos Aires, Argentina",
            description: [
                "ImplementaciÃ³n de modelos paramÃ©tricos y no paramÃ©tricos de valor de usuario a nivel de usuario",
                "Mejoramiento de los modelos de detecciÃ³n de fuga de usuarios",
                "Desarrollo de un paquete de R para uso interno dentro de la empresa",
                "EvaluaciÃ³n de nuevas tecnologÃ­as para entrenamiento de modelos",
                "Desarrollo de modelos de Aprendizaje profundo para clasificaciÃ³n de imÃ¡genes",
                "Desarrollo de modelos para generar mejor experiencia de usuario a los jugadores"
            ]
        },
        {
            title: "Data Scientist",
            company: "Agnostic IT",
            date: "Dic 2016 - Sept 2017",
            location: "Buenos Aires, Argentina",
            description: [
                "Modelamiento de un sistema de Aprendizaje de MÃ¡quina para detecciÃ³n de fuga de usuarios en una empresa de seguros",
                "ConsultorÃ­a estadÃ­stica y de Aprendizaje de MÃ¡quina"
            ]
        },
        {
            title: "Data Scientist",
            company: "JamCity",
            date: "Ago 2015 - Dic 2016",
            location: "Buenos Aires, Argentina",
            description: [
                "Modelamiento de algoritmos de Aprendizaje de MÃ¡quina para fuga de usuarios y valor de usuario",
                "Mejoramiento del cÃ¡lculo para estimar la habilidad de los usuarios basado en la dificultad de los niveles jugados"
            ]
        }
    ]
};

// Education Data
const educationData = {
    en: [
        {
            degree: "Master's in Computer Science",
            institution: "Escuela Colombiana de IngenierÃ­a",
            date: "2025 - Present"
        },
        {
            degree: "Specialization in Data Mining and Knowledge Discovery",
            institution: "Universidad de Buenos Aires",
            date: "2015 - 2016"
        },
        {
            degree: "Bachelor in Statistics",
            institution: "Universidad Nacional de Colombia",
            date: "2007 - 2013"
        }
    ],
    es: [
        {
            degree: "MaestrÃ­a en InformÃ¡tica",
            institution: "Escuela Colombiana de IngenierÃ­a",
            date: "2025 - Actualmente"
        },
        {
            degree: "EspecializaciÃ³n en MinerÃ­a de Datos y Descubrimiento del Conocimiento",
            institution: "Universidad de Buenos Aires",
            date: "2015 - 2016"
        },
        {
            degree: "EstadÃ­stico",
            institution: "Universidad Nacional de Colombia",
            date: "2007 - 2013"
        }
    ]
};

// Projects Data
const projectsData = {
    en: [
        {
            title: "LLM Vulnerability Assessment System",
            type: "Professional Project",
            icon: "ðŸ”’",
            description: "Developed a comprehensive system to evaluate vulnerabilities in Large Language Models, implementing security testing frameworks and automated vulnerability detection algorithms.",
            tech: ["Python", "PyTorch", "LLM APIs", "Security Testing"],
            link: null
        },
        {
            title: "User Intent Analysis with AI",
            type: "Professional Project",
            icon: "ðŸ¤–",
            description: "Created an AI-powered conversation analysis system to determine user intentions, improving customer service automation and user experience personalization.",
            tech: ["Python", "NLP", "Machine Learning", "API Integration"],
            link: null
        },
        {
            title: "Anomaly Detection System",
            type: "Professional Project",
            icon: "ðŸ“Š",
            description: "Built a real-time anomaly detection system for game metrics using statistical techniques and machine learning, reducing issue detection time by 70%.",
            tech: ["Python", "Statistical Analysis", "Real-time Processing", "Alerting"],
            link: null
        },
        {
            title: "User Value Prediction Models",
            type: "Professional Project",
            icon: "ðŸ’°",
            description: "Implemented parametric and non-parametric models to predict user lifetime value at individual user level, improving marketing ROI by 40%.",
            tech: ["R", "Python", "Statistical Modeling", "A/B Testing"],
            link: null
        },
        {
            title: "Deep Learning Image Classification",
            type: "Professional Project",
            icon: "ðŸ–¼ï¸",
            description: "Developed deep learning models for automated image classification in gaming applications, achieving 95% accuracy on production data.",
            tech: ["PyTorch", "CNN", "Transfer Learning", "Computer Vision"],
            link: null
        },
        {
            title: "Automated ELT Pipeline",
            type: "Professional Project",
            icon: "ðŸ”„",
            description: "Designed and implemented automated ELT processes using modern data engineering tools, reducing data processing time by 60%.",
            tech: ["Matillion", "Airflow", "AWS Lambda", "SQL"],
            link: null
        },
        {
            title: "R Package for Internal Analytics",
            type: "Open Source Contribution",
            icon: "ðŸ“¦",
            description: "Created a custom R package for internal company use, standardizing data analysis workflows and improving team productivity.",
            tech: ["R", "Package Development", "Documentation", "Testing"],
            link: null
        },
        {
            title: "Reinforcement Learning for User Segmentation",
            type: "Research Project",
            icon: "ðŸŽ¯",
            description: "Explored reinforcement learning techniques for dynamic user segmentation, improving personalization strategies and user engagement.",
            tech: ["Python", "Reinforcement Learning", "Experimentation", "Analytics"],
            link: null
        }
    ],
    es: [
        {
            title: "Sistema de EvaluaciÃ³n de Vulnerabilidades en LLM",
            type: "Proyecto Profesional",
            icon: "ðŸ”’",
            description: "DesarrollÃ© un sistema integral para evaluar vulnerabilidades en Modelos de Lenguaje Grande, implementando frameworks de pruebas de seguridad y algoritmos de detecciÃ³n automatizada.",
            tech: ["Python", "PyTorch", "APIs LLM", "Pruebas de Seguridad"],
            link: null
        },
        {
            title: "AnÃ¡lisis de IntenciÃ³n de Usuario con IA",
            type: "Proyecto Profesional",
            icon: "ðŸ¤–",
            description: "CreÃ© un sistema de anÃ¡lisis de conversaciones impulsado por IA para determinar intenciones de usuarios, mejorando la automatizaciÃ³n del servicio al cliente.",
            tech: ["Python", "NLP", "Aprendizaje AutomÃ¡tico", "IntegraciÃ³n API"],
            link: null
        },
        {
            title: "Sistema de DetecciÃ³n de AnomalÃ­as",
            type: "Proyecto Profesional",
            icon: "ðŸ“Š",
            description: "ConstruÃ­ un sistema de detecciÃ³n de anomalÃ­as en tiempo real para mÃ©tricas de juegos usando tÃ©cnicas estadÃ­sticas, reduciendo el tiempo de detecciÃ³n en 70%.",
            tech: ["Python", "AnÃ¡lisis EstadÃ­stico", "Procesamiento en Tiempo Real", "Alertas"],
            link: null
        },
        {
            title: "Modelos de PredicciÃ³n de Valor de Usuario",
            type: "Proyecto Profesional",
            icon: "ðŸ’°",
            description: "ImplementÃ© modelos paramÃ©tricos y no paramÃ©tricos para predecir el valor de vida del usuario a nivel individual, mejorando el ROI de marketing en 40%.",
            tech: ["R", "Python", "Modelado EstadÃ­stico", "Pruebas A/B"],
            link: null
        },
        {
            title: "ClasificaciÃ³n de ImÃ¡genes con Deep Learning",
            type: "Proyecto Profesional",
            icon: "ðŸ–¼ï¸",
            description: "DesarrollÃ© modelos de aprendizaje profundo para clasificaciÃ³n automÃ¡tica de imÃ¡genes en aplicaciones de juegos, logrando 95% de precisiÃ³n.",
            tech: ["PyTorch", "CNN", "Transfer Learning", "VisiÃ³n por Computadora"],
            link: null
        },
        {
            title: "Pipeline ELT Automatizado",
            type: "Proyecto Profesional",
            icon: "ðŸ”„",
            description: "DiseÃ±Ã© e implementÃ© procesos ELT automatizados usando herramientas modernas de ingenierÃ­a de datos, reduciendo el tiempo de procesamiento en 60%.",
            tech: ["Matillion", "Airflow", "AWS Lambda", "SQL"],
            link: null
        },
        {
            title: "Paquete R para AnÃ¡lisis Interno",
            type: "ContribuciÃ³n Open Source",
            icon: "ðŸ“¦",
            description: "CreÃ© un paquete R personalizado para uso interno de la empresa, estandarizando flujos de trabajo de anÃ¡lisis y mejorando la productividad del equipo.",
            tech: ["R", "Desarrollo de Paquetes", "DocumentaciÃ³n", "Testing"],
            link: null
        },
        {
            title: "Aprendizaje por Refuerzo para SegmentaciÃ³n",
            type: "Proyecto de InvestigaciÃ³n",
            icon: "ðŸŽ¯",
            description: "ExplorÃ© tÃ©cnicas de aprendizaje por refuerzo para segmentaciÃ³n dinÃ¡mica de usuarios, mejorando estrategias de personalizaciÃ³n y engagement.",
            tech: ["Python", "Aprendizaje por Refuerzo", "ExperimentaciÃ³n", "Analytics"],
            link: null
        }
    ]
};

// State
let currentLang = 'en';
let currentTheme = 'dark';

// Initialize
document.addEventListener('DOMContentLoaded', () => {
    initCanvas();
    initTheme();
    initLanguage();
    renderExperience();
    renderEducation();
    renderProjects();
    setupEventListeners();
    animateOnScroll();
});

// Canvas Animation (Data Science themed - neural network visualization)
function initCanvas() {
    const canvas = document.getElementById('dataCanvas');
    const ctx = canvas.getContext('2d');
    
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    
    const particles = [];
    const particleCount = 80;
    
    class Particle {
        constructor() {
            this.x = Math.random() * canvas.width;
            this.y = Math.random() * canvas.height;
            this.vx = (Math.random() - 0.5) * 0.5;
            this.vy = (Math.random() - 0.5) * 0.5;
            this.radius = Math.random() * 2 + 1;
        }
        
        update() {
            this.x += this.vx;
            this.y += this.vy;
            
            if (this.x < 0 || this.x > canvas.width) this.vx *= -1;
            if (this.y < 0 || this.y > canvas.height) this.vy *= -1;
        }
        
        draw() {
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
            ctx.fillStyle = currentTheme === 'dark' ? 'rgba(0, 217, 255, 0.5)' : 'rgba(0, 102, 204, 0.5)';
            ctx.fill();
        }
    }
    
    for (let i = 0; i < particleCount; i++) {
        particles.push(new Particle());
    }
    
    function connectParticles() {
        for (let i = 0; i < particles.length; i++) {
            for (let j = i + 1; j < particles.length; j++) {
                const dx = particles[i].x - particles[j].x;
                const dy = particles[i].y - particles[j].y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < 150) {
                    ctx.beginPath();
                    ctx.strokeStyle = currentTheme === 'dark' 
                        ? `rgba(0, 217, 255, ${0.2 * (1 - distance / 150)})`
                        : `rgba(0, 102, 204, ${0.2 * (1 - distance / 150)})`;
                    ctx.lineWidth = 1;
                    ctx.moveTo(particles[i].x, particles[i].y);
                    ctx.lineTo(particles[j].x, particles[j].y);
                    ctx.stroke();
                }
            }
        }
    }
    
    function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        particles.forEach(particle => {
            particle.update();
            particle.draw();
        });
        
        connectParticles();
        requestAnimationFrame(animate);
    }
    
    animate();
    
    window.addEventListener('resize', () => {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    });
}

// Theme Toggle
function initTheme() {
    const savedTheme = localStorage.getItem('theme') || 'dark';
    currentTheme = savedTheme;
    document.body.setAttribute('data-theme', savedTheme);
    updateThemeIcon();
}

function toggleTheme() {
    currentTheme = currentTheme === 'dark' ? 'light' : 'dark';
    document.body.setAttribute('data-theme', currentTheme);
    localStorage.setItem('theme', currentTheme);
    updateThemeIcon();
}

function updateThemeIcon() {
    const icon = document.querySelector('#themeToggle .icon');
    icon.textContent = currentTheme === 'dark' ? 'â˜€ï¸' : 'ðŸŒ™';
}

// Language Toggle
function initLanguage() {
    const savedLang = localStorage.getItem('language') || 'en';
    currentLang = savedLang;
    updateLanguage();
}

function toggleLanguage() {
    currentLang = currentLang === 'en' ? 'es' : 'en';
    localStorage.setItem('language', currentLang);
    updateLanguage();
}

function updateLanguage() {
    // Update language toggle button
    document.querySelector('#langToggle .lang-text').textContent = currentLang === 'en' ? 'ES' : 'EN';
    
    // Update all elements with data-en and data-es attributes
    document.querySelectorAll('[data-en][data-es]').forEach(el => {
        el.textContent = el.getAttribute(`data-${currentLang}`);
    });
    
    // Update HTML lang attribute
    document.documentElement.lang = currentLang;
    
    // Re-render dynamic content
    renderExperience();
    renderEducation();
    renderProjects();
}

// Render Projects
function renderProjects() {
    const grid = document.querySelector('.projects-grid');
    grid.innerHTML = '';
    
    projectsData[currentLang].forEach((project, index) => {
        const card = document.createElement('div');
        card.className = 'project-card';
        card.style.animationDelay = `${index * 0.1}s`;
        
        const techTags = project.tech.map(tech => `<span class="tech-tag">${tech}</span>`).join('');
        const linkHTML = project.link 
            ? `<a href="${project.link}" class="project-link" target="_blank">
                ${currentLang === 'en' ? 'View Project' : 'Ver Proyecto'} â†’
               </a>`
            : '';
        
        card.innerHTML = `
            <div class="project-header">
                <div class="project-icon">${project.icon}</div>
                <h3 class="project-title">${project.title}</h3>
                <div class="project-type">${project.type}</div>
            </div>
            <div class="project-body">
                <p class="project-description">${project.description}</p>
                <div class="project-tech">${techTags}</div>
                ${linkHTML}
            </div>
        `;
        
        grid.appendChild(card);
    });
}

// Render Experience
function renderExperience() {
    const timeline = document.querySelector('.timeline');
    timeline.innerHTML = '';
    
    experienceData[currentLang].forEach((exp, index) => {
        const item = document.createElement('div');
        item.className = 'timeline-item';
        item.style.animationDelay = `${index * 0.1}s`;
        
        const descriptionHTML = exp.description.map(desc => `<li>${desc}</li>`).join('');
        
        item.innerHTML = `
            <div class="timeline-content">
                <div class="timeline-header">
                    <div>
                        <h3 class="timeline-title">${exp.title}</h3>
                        <div class="timeline-company">${exp.company}</div>
                    </div>
                    <div class="timeline-date">${exp.date}</div>
                </div>
                <div class="timeline-location">${exp.location}</div>
                <ul class="timeline-description">
                    ${descriptionHTML}
                </ul>
            </div>
        `;
        
        timeline.appendChild(item);
    });
}

// Render Education
function renderEducation() {
    const grid = document.querySelector('.education-grid');
    grid.innerHTML = '';
    
    educationData[currentLang].forEach((edu, index) => {
        const card = document.createElement('div');
        card.className = 'education-card';
        card.style.animationDelay = `${index * 0.2}s`;
        
        card.innerHTML = `
            <h3 class="education-degree">${edu.degree}</h3>
            <div class="education-institution">${edu.institution}</div>
            <div class="education-date">${edu.date}</div>
        `;
        
        grid.appendChild(card);
    });
}

// Event Listeners
function setupEventListeners() {
    document.getElementById('themeToggle').addEventListener('click', toggleTheme);
    document.getElementById('langToggle').addEventListener('click', toggleLanguage);
    
    // Smooth scroll for navigation
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        });
    });
}

// Animate on Scroll
function animateOnScroll() {
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.opacity = '1';
                entry.target.style.transform = 'translateY(0)';
            }
        });
    }, { threshold: 0.1 });
    
    document.querySelectorAll('.skill-card, .timeline-item, .education-card, .project-card, .highlight-item').forEach(el => {
        el.style.opacity = '0';
        el.style.transform = 'translateY(20px)';
        el.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
        observer.observe(el);
    });
}

// Add interactive hover effects for skill cards
document.addEventListener('DOMContentLoaded', () => {
    setTimeout(() => {
        document.querySelectorAll('.skill-card').forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-10px) scale(1.05)';
            });
            
            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0) scale(1)';
            });
        });
    }, 500);
});
